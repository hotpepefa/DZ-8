# DZ-8
Scapy Gruyere XSS

2 ЭТАП
Установлен Scapy
Ознакомился с инструментом Google Gruyere
Создан скрипт для перехвата трафика
scapy_xss_analyzer.py - скрипт анализа трафика

Запущен скрипт анализа
Открыт Google Gruyere в браузере
Выполнены действия в Gruyere:
Создан аккаунт (Sign up)
Логирование (Login)
Просмотр профилей
Перехвачены TCP пакеты
Пакеты сохранены в файл test.pcap

3 ЭТАП
Для эксплуатации XSS был выполнен запрос POST запрос 
curl -X POST "http://google-gruyere.appspot.com/448339518601989402988130084125103842370/snippet" \
-d "title=test&snippet=<script>alert('XSS')</script>"
Пакеты сохранены в файл gruyere_xss.pcap

При XSS-атаке HTTP-запрос включал в тело параметр snippet=<script>alert('XSS')</script> методом POST. Сервер вернул HTML-ответ, в котором этот скрипт был включён в тело страницы без экранирования. В результате браузер исполнил JavaScript, что подтверждает наличие отражённой XSS-уязвимости. В обычных запросах таких тегов не было; структура ответа отличалась отсутствием <script>-блоков.

Рекомендации по защите:
Экранирование пользовательского ввода (Output Encoding)
Использование безопасных шаблонизаторов
Фильтрация и валидация входных данных
Использование Content Security Policy (CSP)
